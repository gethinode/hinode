{{/* 
    Copyright Â© 2025 - 2026 The Hinode Team / Mark Dumay. All rights reserved.
    Use of this source code is governed by The MIT License (MIT) that can be found in the LICENSE file.
    Visit gethinode.com/license for more details.

	Note: To support live editing, bookshop components should use a clear path to the provided arguments.
	Therefore, we cannot use the InitArgs partial at this point, and we need to access each argument
	directly. See the docs for more background:
	https://github.com/CloudCannon/bookshop/blob/main/guides/hugo.adoc#passing-data-to-bookshop-components
*/}}

{{/* Initialize global arguments */}}
{{- $breakpoint := partial "utilities/GetBreakpoint.html" -}}
{{- $padding := partial "utilities/GetPadding.html" -}}

{{/* Initialize local variables */}}
{{ $raw := "" }}
{{ $list := slice }}
{{ range .elements }}
	<!-- TODO: check mode -->
	{{ $list = $list | append (dict 
		"title"        .title
		"description"  (.content | page.RenderString)
		"icon"         .icon
		"thumbnail"    .image
		"href"         .link
		"button"       (isset . "link")
		"button-label" .label
	) }}
{{ end}}

{{/* Main code */}}
{{- $raw = printf "%s%s" $raw (partial "assets/section-title.html" (dict
	"heading" .heading
	"justify" .justify
	"class"   (printf "pb-%d" $padding.y)))
-}}

{{/* Init base arguments for card group */}}
{{ $params := dict 
	"page"         page
	"list"         $list
	"class"        (printf "border-0 card-icon-primary %s" (or .class ""))
	"cols"         .cols
	"gutter"       "4"
	"padding"      .padding
	"header-style" "none"
	"footer-style" "none"
	"icon-rounded" (or .icon_rounded (index . "icon-rounded"))
	"icon-style"   (or .icon_style (index . "icon-style") "fa-2x")
	"link-type"    (or .link_type (index . "link-type"))
	"align"        .align
	"hook"         "assets/live-card.html"
}}

{{/* Layout for small screens */}}
{{- $raw = printf "%s%s" $raw (partial "assets/card-group.html" (merge $params (dict 
	"orientation"  (.orientation | default "horizontal-sm")
	"wrapper"      (printf "d-%s-none" $breakpoint.prev)
))) -}}

{{/* Layout for regular screens */}}
{{- $raw = printf "%s%s" $raw (partial "assets/card-group.html" (merge $params (dict 
	"orientation"  (.orientation | default "stacked")
	"wrapper"      (printf "d-none d-%s-block" $breakpoint.prev)
))) -}}

{{ if $raw }}
	{{ partial "utilities/section.html" (dict 
		"component-name" "cards"
		"id"             .id
		"raw"            $raw
		"background"     .background
		"width"          .width
		"justify"        .justify
		"wrapper"        .wrapper
		"fluid"          .fluid
		"theme"          .theme
		"cover"          .cover
		"overlay-mode"   (or .overlay_mode (index . "overlay-mode"))
		"section-class"  (or .section_class (index . "section-class"))
		"bg-class"       (or .bg_class (index . "bg-class"))
	)}}
{{ end }}